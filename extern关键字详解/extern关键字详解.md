我确定这篇文章对c语言的初学者会有很大的帮助，因为这将使他们更好更熟练的使用c语言。所以就让我先来说说`extern`关键字在变量和函数上的应用。最基本的`extern`关键字扩展了变量和函数的可见度。这可能就是它为什么命名为`extern`的原因。

几乎所有人都知道声明和定义变量(函数)的意义，但是为了这篇文章的完整性，我想弄清楚它们。`声明`一个变量(函数)只是表明这个变量(函数)存在于程序的某个地方，并没有为它们分配内存。但是，声明变量(函数)具有重要作用，那就是说明变量(函数)的类型。因此，当一个变量声明，程序知道变量的类型，在函数声明的情况下，程序知道函数的参数和返回类型。这就是所谓的声明。来到`定义`，当我们定义一个变量(函数)，除了声明的作用，它也为该变量(函数)分配内存。因此，我们可以认为声明是定义的子集。从上面的说明，显而易见，变量(函数)可以声明多次，只能定义一次。

现在回到我们的主要目标：理解C语言中的关键字`extern`。我已经解释过`声明`和`定义`的作用了，因为我们必须借助它们来理解关键字`extern`。我们先来了解一种简单的情况，`extern`对函数的作用。默认情况下，声明和定义一个函数，都有一个`extern`的前缀，这意味着在声明和定义函数时，前面不写`extern`，它也是默认存在的。例如下面的代码。

```cpp
int foo(int arg1, char arg2);
```

声明的函数前面没有`extern`，但编译器会在前面加上关键字`extern`，如下

```cpp
extern int foo(int arg1, char arg2);
```

定义函数的情况和上面一样(函数的定义是指带有函数体)。因此，每当我们定义一个函数的时候，前面总会有默认的关键字`extern`。由于声明可以多次重复，定义只能完成一次，我们可以看到一个函数的声明可以在多个C/H文件或单个的C/H文件中重复多次。但是该函数实际只定义了一次(`仅在一个文件中`)。这样的函数在整个程序中都是可见的，任何文件任何地方都可以调用。(通过函数的声明，编译器在编译时就知道函数定义在哪里)。

第二种情况，`extern`对变量的作用。如何声明一个变量而不定义它？这是一个理解`extern`对变量作用的重要问题，答案如下：

```csharp
extern int var;
```

在上面，一个整型变量`var`被声明(没有定义，没有分配内存)。并且，根据需要，我们可以声明多次。

现在，如何定义一个变量？答案如下：

```csharp
int var;
```

在这里，声明及定义了一个整型变量`var`(声明是定义的子集，定义一个变量就包含了声明)，这里还为变量`var`分配了内存。现在，让我们感到惊讶的是，当我们定义或声明一个函数时，前面会有默认的`extern`，但对于变量的情况就不一样了。如果变量也和函数一样，那么它们永远不会分配内存，它们仅仅被声明。因此，当我们想要声明而不定义一个变量就需要加上关键字`extern`。此外`extern`将变量的能见度延伸到了整个程序，我们知道变量声明和定义的地方，可以在整个程序的任何地方使用它们。下面借助几个例子来理解`extern`

```csharp
int var;

int main(void)
{
   var = 10;
   return 0;
}
```

分析：程序编译成功，`var`是一个全局变量(隐势声明)

```csharp
extern int var;

int main(void)
{
  return 0;
}
```

分析：程序编译成功，这里`var`只被声明，其他地方没有使用`var`，所以没问题。

```csharp
extern int var;
int main(void)
{
 var = 10;
 return 0;
}
```

分析：程序编译错误，由于声明了变量`var`，而没有在其他地方定义，从本质上讲，没有为`var`分配内存，程序又要给它赋值。

```cpp
#include "somefile.h"
extern int var;

int main(void)
{
 var = 10;
 return 0;
}
```

分析：如果文件`somefile.h`文件中有定义变量`var`, 程序将会编译成功。

```csharp
extern int var = 0;
int main(void)
{
 var = 10;
 return 0;
}
```

分析：猜猜上面的代码能否编译成功？在这里按照C的标准是可以编译通过的。声明一个变量并给它初始化一个值，则该变量的内存将被分配，即该变量被定义。(有的编译器会报告一个警告：`warning: 'extern' variable has an initializer`)

所以，我们可以得出结论：

 

1. 声明可以多次，定义只能一次。
2. 关键字`extern`用于扩展变量和函数的可见性。
3. 由于函数默认存在`extern`,不需要再定义和声明的时候使用`extern`。
4. 当变量使用`extern`时，它只是声明没有定义。
5. 当变量用`extern`声明并且有初始化时，和变量的定义一样。

https://segmentfault.com/a/1190000008949574